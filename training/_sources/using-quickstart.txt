==============================
How to run |quick| simulations
==============================

This topic describes how to run simulations to model the scenarios provided with the |quick|.  Each
of the tutorials in the |quick| documentation describes in more detail how to modify various
parameters to model disease and the rationale and mathematics behind the |EMOD_s| model. This topic
describes in a broader sense how to run simulations.

Outside of the |quick|, simulations are generally run using command-line options and the JSON files
that control the configuration and campaign are modified directly. While there's nothing preventing
you from running simulations using the scenarios here at the command line, this process is not
documented here because it is more complicated. If you would like to learn more about running
simulations this way so you can leverage the full power of |EMOD_s|, see any of the other
documentation sets.

In general, we assume you will be running simulations using the |Excel| because this interface
allows you to easily view and modify the parameters associated with each of the scenarios and
greater control in plotting the output. However, you also have the option of running scenarios using
the provided Windows command and batch scripts.

Run a simulation using the |Excel|
==================================

#.  Open Windows Explorer.

#.  Navigate to the |quick| on the virtual Z drive (or other virtual drive you set up during installation).

    If you get an error, re-run the environment setup script. See :doc:`install-overview`.

#.  In the Scenarios directory, open the directory of the scenario you want to simulate. The tutorials
    will guide you through the scenarios in greater detail.

#.  Double-click config.xlsm.

#.  If a warning appears, click **Update** to dismiss it.

#.  If you've made any changes, save the workbook.

    The Commissioning sheet contains parameters that control how and where the simulation runs. You
    generally will not need to modify this sheet. The other sheets contain configuration and
    campaign parameters. Follow the instructions in the tutorial to modify these parameters as
    necessary.

#.  Select the **CONTROL** sheet tab.

#.  Click **EXECUTE**.

    If a security notice appears, click **Enable Macros** to dismiss it.

    This will open a Command Prompt window for simulation output and logging. Ignore the EMOD_Macros.xslm
    file that opens.

#.  In the Command Prompt window, verify that you see the following output:

    "Controller executed successfully."

#.  Close the Command Prompt window to open the InsetChart workbook.

    This workbook contains the simulation-wide averages of :term:`prevalence`, :term:`incidence`,
    and other common metrics at each :term:`time step`.

#.  If desired, use **Save as** to save the results of the simulation with a different name. By
    default, files will be saved in the testing directory.

#.  To plot the output, press Ctrl and select the columns of interest, then on the Insert tab, select
    a 2-D line chart.

    For example, press Ctrl and select columns B, J, and L to plot the recovered, susceptible, and
    infectious populations at each time step. Of course, you can use any of the Microsoft Excel
    plotting features to plot the output data in different ways.

Run a simulation using scripts
==============================

#.  Open Windows Explorer.

#.  Navigate to the |quick| on the virtual Z drive (or other virtual drive you set up during installation).

    If you get an error, re-run the environment setup script. See :doc:`install-overview`.

#.  In the Scenarios directory, open the directory of the scenario you want to simulate.

    If you want to make changes to the campaign or configuration files, open the JSON file in a text
    editor, make your changes, and save. The tutorials will guide you through the scenarios in
    greater detail.

#.  Double-click runEmod.cmd.

    This will open a Command Prompt window for simulation output and logging.

#.  In the Command Prompt window, verify that you see the following output:

    "Controller executed successfully." You may then close the window. By default, output files will be
    saved in the output directory.

#.  To plot the output, double-click plotInsetChart.bat or plotAllCharts.bat.

    These batch files use Python to create plots of campaign cost, exposed and recovered population,
    new infections, and more. Note that all batch files assume that Python is installed at
    C:\Python27. If Python is installed in a different location, use a plain text editor to modify
    the path in the batch files.

